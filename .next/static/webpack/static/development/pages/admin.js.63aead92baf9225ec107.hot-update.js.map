{"version":3,"file":"static/webpack/static\\development\\pages\\admin.js.63aead92baf9225ec107.hot-update.js","sources":["webpack:///./containers/Auth/Auth.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { googleKey } from '../../keys'\r\nimport { icons } from '../../icons/icons'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\n\r\nconst css = require('./Auth.module.css')\r\n\r\ninterface IError {\r\n    error: boolean\r\n    errorInfo?: {\r\n        code: string\r\n        message: string\r\n    }\r\n}\r\n\r\ninterface IAuthComponent {\r\n    setSending: (newSending: boolean) => void\r\n    signIn: (email: string, password: string, idToken: string) => void\r\n}\r\n\r\nconst Auth: React.FunctionComponent<IAuthComponent> = ({ setSending, signIn }): JSX.Element => {\r\n    const [error, setError] = React.useState<IError>({ error: false })\r\n\r\n    const signInHandler = (email: string, password: string) =>  {\r\n        setSending(true)\r\n        const baseURL: string =\"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword\"\r\n        const apiKey: string = `?key=${googleKey}`\r\n        const payload = JSON.stringify({\r\n            email: email,\r\n            password: password,\r\n            returnSecureToken: true\r\n        })\r\n        \r\n         fetch(baseURL + apiKey, { method: 'post', body: payload }).then(response => response.json()\r\n            ).then(data => {\r\n                if (data.error) {\r\n                    setError({ \r\n                        error: true, \r\n                        errorInfo: { \r\n                            code: data.error.code,\r\n                            message: data.error.message\r\n                        }\r\n                    })\r\n                    setSending(false)\r\n                } else {\r\n                    // console.log(data)\r\n                    const idToken: string = data?.idToken\r\n                    const refreshToken: string = data?.refreshToken\r\n                    const email: string = data?.email\r\n                    const password: string = data?.password\r\n                    const expireTime: string = String(new Date().getTime() + data?.expiresIn * 1000)\r\n                    localStorage.setItem('idToken', idToken)\r\n                    localStorage.setItem('refreshToken', refreshToken)\r\n                    localStorage.setItem('password', password)\r\n                    localStorage.setItem('email', email)\r\n                    localStorage.setItem('expireTime', expireTime)\r\n                    setSending(false)\r\n                    setError({ error: false })\r\n                    signIn(email, password, idToken)\r\n                }\r\n            })\r\n    }\r\n\r\n    return (\r\n        <div className={css.Container}>\r\n            <AuthForm submit={signInHandler} error={error} />\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface IFormElement {\r\n    id: string\r\n    inputType: string\r\n    value: string\r\n    placeholder?: string\r\n    require?: boolean\r\n    className?: string\r\n    icon? : { focus?: any, unfocus?: any }\r\n}\r\n\r\ninterface IFormState {\r\n    [email: string]: IFormElement\r\n    password: IFormElement\r\n}\r\n\r\nconst initialAuthFormState: IFormState = {\r\n    email: {\r\n        id: 'email',\r\n        inputType: 'email',\r\n        placeholder: 'email',\r\n        require: true,\r\n        value: '',\r\n        className: css.EmailInput,\r\n        icon: { focus: icons.faEnvelopeOpen, unfocus: icons.faEnvelope }\r\n    },\r\n    password: {\r\n        id: 'password',\r\n        inputType: 'password',\r\n        placeholder: 'password',\r\n        require: true,\r\n        value: '',\r\n        className: css.PasswordInput,\r\n        icon: { focus: icons.faUnlock, unfocus: icons.faLock }\r\n    },\r\n}\r\n\r\ninterface IAuthForm {\r\n    submit: (email: string, password: string) => void\r\n    error?: IError\r\n}\r\n\r\nconst AuthForm: React.FunctionComponent<IAuthForm> = ({ submit, error }): JSX.Element => {\r\n    const [formState, setFormState] = React.useState<IFormState>(initialAuthFormState)\r\n\r\n    React.useEffect(() => {\r\n        const keyHandler = (event: KeyboardEvent) => {\r\n            if (event.key === 'Enter') {\r\n                signInHandler()\r\n            }\r\n        }\r\n\r\n        window.addEventListener('keydown', keyHandler, true)\r\n\r\n        return () => window.removeEventListener('keydown', keyHandler, true)\r\n    }, [formState])\r\n\r\n    const changeHandler = (elemKey: string, event: React.ChangeEvent<HTMLInputElement>) => {\r\n        const updatedFormState: IFormState = {\r\n            ...formState,\r\n            [elemKey]: {\r\n                ...formState[elemKey],\r\n                value: event.target.value\r\n            }\r\n        }\r\n        setFormState(updatedFormState)\r\n    }\r\n\r\n    const signInHandler = () => {\r\n        submit(formState.email.value, formState.password.value)\r\n    }\r\n\r\n    return (\r\n        <div className={css.AuthFormContainer}>\r\n            {/* <h2 className={css.FormTitle}>Admin Auth</h2> */}\r\n            <form className={css.AuthForm}>\r\n                { Object.keys(formState).map((elementKey: string) => {\r\n                    return (\r\n                        <InputComponent key={elementKey} {...formState[elementKey]} changed={changeHandler} />\r\n                    )\r\n                })}\r\n            </form>\r\n            { error?.error && <p className={css.ErrorText}>{error.errorInfo?.message}</p> }\r\n            <div className={css.SubmitButton} onClick={signInHandler}>\r\n                <p>Sign In</p>\r\n                <FontAwesomeIcon icon={icons.faSignInAlt} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface IInputComponent extends IFormElement {\r\n    changed: (elemKey: string, event: React.ChangeEvent<HTMLInputElement>) => void\r\n}\r\n\r\nconst InputComponent: React.FunctionComponent<IInputComponent> = (props): JSX.Element => {\r\n    const [isFocused, setIsFocused] = React.useState<boolean>(false)\r\n\r\n    const containerClasses = [\r\n        css.InputContainer,\r\n        isFocused && css.focus,\r\n    ].join(' ')\r\n\r\n    const iconClasses = [\r\n        css.InputIcon,\r\n        isFocused && css.focus\r\n    ].join(' ')\r\n\r\n    const spanClasses = [\r\n        css.Span,\r\n        isFocused && css.focus\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div className={containerClasses}>\r\n            { props.icon &&  \r\n                <div className={css.IconContainer}>\r\n                    <FontAwesomeIcon className={iconClasses} icon={props.icon?.unfocus} />\r\n                </div>\r\n            }\r\n            <input className={props.className} \r\n                placeholder={!isFocused ? props.placeholder : ''}\r\n                value={props.value} \r\n                type={props.inputType}\r\n                onChange={(e) => props.changed(props.id, e)}\r\n                onFocus={() => setIsFocused(true)}\r\n                onBlur={() => setIsFocused(false)} /> \r\n            <span className={spanClasses}></span>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Auth"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAcA;AAAA;AAAA;AACA;AADA;AACA;AAAA;AADA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAHA;AACA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAOA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAPA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAPA;AAVA;AACA;AAyBA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAIA;AAJA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAIA;AACA;AAKA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAEA;AAKA;AAKA;AAKA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AANA;AAOA;AAAA;AAGA;AACA;AACA;;;;A","sourceRoot":""}