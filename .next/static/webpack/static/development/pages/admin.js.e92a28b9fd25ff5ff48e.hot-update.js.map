{"version":3,"file":"static/webpack/static\\development\\pages\\admin.js.e92a28b9fd25ff5ff48e.hot-update.js","sources":["webpack:///./pages/admin/index.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { NextPage } from 'next'\n\nimport { CubeSpinner } from '../../components/UI/Spinner/Spinner'\nimport Auth from '../../containers/Auth/Auth'\nimport Admin from '../../containers/Admin/Admin'\n\nconst css = require('./index.module.css')\n\ntype TAuthState = {\n    signedIn: boolean\n    email?: string\n    password?: string\n    idToken?: string\n}\n\ntype TAuthActions = \n| ({ type: 'signin', payload: { email: string, password: string, idToken: string } })\n| ({ type: 'signout' })\n\nconst initialAuthState: TAuthState = {\n    signedIn: false\n}\n\nconst signIn = (state: TAuthState, action: TAuthActions): TAuthState => {\n    if (action.type !== 'signin') return { ...state }\n    \n    const updatedState: TAuthState = {\n        ...state,\n        signedIn: true,\n        email: action.payload?.email,\n        password: action.payload?.password,\n        idToken: action.payload?.idToken,\n    }\n\n    return {\n        ...updatedState\n    }\n}\n\nconst authReducer = (state: TAuthState = initialAuthState, action: TAuthActions): TAuthState => {\n    switch (action.type) {\n        case 'signin':\n            return signIn(state, action)\n\n        case 'signout':\n            return {\n                signedIn: false\n            }\n    \n        default:\n            return { ...state }\n    }\n}\n\n\nconst AdminPage: NextPage = (): JSX.Element => {\n    const [state, dispatch] = React.useReducer(authReducer, initialAuthState)\n    const [sending, setSending] = React.useState<boolean>(true)\n    const [screensize, setScreensize] = React.useState<{ width: number, height: number}>()\n\n    React.useEffect(() => {\n        document.title = 'Portfolio // Admin'\n\n        setScreensize({\n            width: window.innerWidth,\n            height: window.innerHeight\n        })\n\n        if (localStorage.length !== 0) {\n            // check for auth info in local storage\n            // compare current time in milliseconds to expire time in storage\n            // if current time is LESS, use the auth info from storage to refresh\n            // else, clear local storage\n            const expireTime = (localStorage.getItem('expireTime'))\n            if (expireTime) {\n                // if auth token has not expired yet\n                if (new Date().getTime() < +expireTime) {\n                    const authInfo = {\n                        email: localStorage.getItem('email')!,\n                        password: localStorage.getItem('password')!,\n                        idToken: localStorage.getItem('idToken')!\n                    }\n                    dispatch({ type: 'signin', payload: authInfo })\n                    setSending(false)\n                // if auth has expired\n                } else {\n                    localStorage.clear()\n                    setSending(false)\n                }\n            }\n        } else {\n            setSending(false)\n        }\n    }, [])\n\n    const signInHandler = (email: string, password: string, idToken: string) => {\n        const authInfo = {\n            email: email,\n            password: password,\n            idToken: idToken\n        }\n        dispatch({ type: 'signin', payload: authInfo })\n    }\n\n    return (\n        <div className={css.Main} style={{minHeight: `${screensize?.height}px`, minWidth: `${screensize?.width}px`}}>\n            { !state.signedIn && <Auth setSending={setSending} signIn={signInHandler} /> }\n            { state.signedIn && <Admin /> }\n            { sending && <Loading /> }\n        </div>\n    )\n}\n\nconst Loading: React.FunctionComponent = (): JSX.Element => (\n    <div className={css.Loading}>\n        <CubeSpinner />\n    </div>\n)\n\n\nexport default AdminPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AADA;AACA;AAGA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AALA;AACA;AAOA;AAGA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAGA;AACA;AAVA;AAYA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AAEA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAKA;AACA;AACA;AAAA;AACA;AAAA;AADA;AACA;AAMA;;;;A","sourceRoot":""}