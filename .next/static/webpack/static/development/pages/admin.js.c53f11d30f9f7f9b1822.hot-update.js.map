{"version":3,"file":"static/webpack/static\\development\\pages\\admin.js.c53f11d30f9f7f9b1822.hot-update.js","sources":["webpack:///./pages/admin/index.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { NextPage } from 'next'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { googleKey } from '../../keys'\nimport { icons } from '../../icons/icons'\n\nconst css = require('./index.module.css')\n\nconst AdminPage: NextPage = (): JSX.Element => {\n    const [isSignedIn, setIsSignedIn] = React.useState<boolean>(false)\n\n    React.useEffect(() => {\n        document.title = 'Portfolio // Admin'\n\n        if (localStorage.length !== 0) {\n            // check for auth info in local storage\n            // compare current time in milliseconds to time in storage\n            // if current time is LESS, use the auth info from storage to refresh\n            // else, clear local storage\n            if (new Date().getTime() < +(localStorage?.getItem('expireTime')!)) {\n                console.log('use old auth info')\n            } else {\n                console.log('clear local storage')\n                localStorage.clear()\n            }\n        }\n        \n    }, [])\n\n    const signInHandler = (email: string, password: string) =>  {\n        const baseURL: string =\"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword\"\n        const apiKey: string = `?key=${googleKey}`\n        const payload = JSON.stringify({\n            email: email,\n            password: password,\n            returnSecureToken: true\n        })\n        \n        fetch(baseURL + apiKey, { method: 'post', body: payload }).then(response => response.json()\n            ).then(data => {\n                const idToken: string = data?.idToken\n                const refreshToken: string = data?.refreshToken\n                const email: string = data?.email\n                const expireTime: string = String(new Date().getTime() + data.expiresIn * 1000)\n                localStorage.setItem('idToken', idToken)\n                localStorage.setItem('refreshToken', refreshToken)\n                localStorage.setItem('email', email)\n                localStorage.setItem('expireTime', expireTime)\n            })\n    }\n\n    return (\n        <div className={css.Main}>\n            { !isSignedIn && <AuthForm signIn={signInHandler} /> }\n        </div>\n    )\n}\n\ninterface IFormElement {\n    id: string\n    inputType: string\n    value: string\n    placeholder?: string\n    require?: boolean\n    className?: string\n    icon? : { focus?: any, unfocus?: any }\n}\n\ninterface IFormState {\n    [email: string]: IFormElement\n    password: IFormElement\n}\n\nconst initialAuthFormState: IFormState = {\n    email: {\n        id: 'email',\n        inputType: 'email',\n        placeholder: 'email',\n        require: true,\n        value: '',\n        className: css.EmailInput,\n        icon: { focus: icons.faEnvelopeOpen, unfocus: icons.faEnvelope }\n    },\n    password: {\n        id: 'password',\n        inputType: 'password',\n        placeholder: 'password',\n        require: true,\n        value: '',\n        className: css.PasswordInput,\n        icon: { focus: icons.faUnlock, unfocus: icons.faLock }\n    },\n}\n\ninterface IAuthForm {\n    signIn: (email: string, password: string) => void\n}\n\nconst AuthForm: React.FunctionComponent<IAuthForm> = ({ signIn }): JSX.Element => {\n    const [formState, setFormState] = React.useState<IFormState>(initialAuthFormState)\n\n    React.useEffect(() => {\n        const keyHandler = (event: KeyboardEvent) => {\n            if (event.key === 'Enter') {\n                signInHandler()\n            }\n        }\n\n        window.addEventListener('keydown', keyHandler, true)\n\n        return () => window.removeEventListener('keydown', keyHandler, true)\n    }, [formState])\n\n    const changeHandler = (elemKey: string, event: React.ChangeEvent<HTMLInputElement>) => {\n        const updatedFormState: IFormState = {\n            ...formState,\n            [elemKey]: {\n                ...formState[elemKey],\n                value: event.target.value\n            }\n        }\n        setFormState(updatedFormState)\n    }\n\n    const signInHandler = () => {\n        signIn(formState.email.value, formState.password.value)\n    }\n\n    return (\n        <div className={css.AuthFormContainer}>\n            {/* <h2 className={css.FormTitle}>Admin Auth</h2> */}\n            <form className={css.AuthForm}>\n                { Object.keys(formState).map((elementKey: string) => {\n                    return (\n                        <InputComponent key={elementKey} {...formState[elementKey]} changed={changeHandler} />\n                    )\n                })}\n            </form>\n            <div className={css.SubmitButton} onClick={signInHandler}>\n                <p>Sign In</p>\n                <FontAwesomeIcon icon={icons.faSignInAlt} />\n            </div>\n        </div>\n    )\n}\n\ninterface IInputComponent extends IFormElement {\n    changed: (elemKey: string, event: React.ChangeEvent<HTMLInputElement>) => void\n}\n\nconst InputComponent: React.FunctionComponent<IInputComponent> = (props): JSX.Element => {\n    const [isFocused, setIsFocused] = React.useState<boolean>(false)\n\n    const containerClasses = [\n        css.InputContainer,\n        isFocused && css.focus,\n    ].join(' ')\n\n    const iconClasses = [\n        css.InputIcon,\n        isFocused && css.focus\n    ].join(' ')\n\n    const spanClasses = [\n        css.Span,\n        isFocused && css.focus\n    ].join(' ')\n\n    return (\n        <div className={containerClasses}>\n            { props.icon &&  \n                <div className={css.IconContainer}>\n                    <FontAwesomeIcon className={iconClasses} icon={props.icon?.unfocus} />\n                </div>\n            }\n            <input className={props.className} \n                placeholder={props.placeholder}\n                value={props.value} \n                type={props.inputType}\n                onChange={(e) => props.changed(props.id, e)}\n                onFocus={() => setIsFocused(true)}\n                onBlur={() => setIsFocused(false)} /> \n            <span className={spanClasses}></span>\n        </div>\n    )\n}\n\nexport default AdminPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAHA;AACA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAGA;AACA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAPA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAPA;AAVA;AACA;AAwBA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAIA;AAJA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAEA;AAAA;AAIA;AACA;AAKA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAEA;AAKA;AAKA;AAKA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AANA;AAOA;AAAA;AAGA;AACA;AACA;;;;A","sourceRoot":""}